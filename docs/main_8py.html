<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Learn by Dueling Term Project: src/main.py File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Learn by Dueling Term Project
   </div>
   <div id="projectbrief">All code necessary to perform heat seeking nerf gun duel</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('main_8py.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">main.py File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This file contains code to run all the necessary tasks to enable the Nerf gun such that it is able to read an image, turn to the specified target, and pull the trigger at the specified time.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2204105a7f23c99016d26c2e1c14f770" id="r_a2204105a7f23c99016d26c2e1c14f770"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2204105a7f23c99016d26c2e1c14f770">main.task1_image</a> (shares)</td></tr>
<tr class="memdesc:a2204105a7f23c99016d26c2e1c14f770"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task 1 puts things into a share, specifically the desired position, a flag to mark whether the image is ready to be processed, and a camera share for data.  <br /></td></tr>
<tr class="separator:a2204105a7f23c99016d26c2e1c14f770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a851cefc0b2d339f4bac9243e473dd588" id="r_a851cefc0b2d339f4bac9243e473dd588"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a851cefc0b2d339f4bac9243e473dd588">main.task2_motor</a> (shares)</td></tr>
<tr class="memdesc:a851cefc0b2d339f4bac9243e473dd588"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task 2 puts things into a share.  <br /></td></tr>
<tr class="separator:a851cefc0b2d339f4bac9243e473dd588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfa73bc731c3f08f1061fa95a93f2c59" id="r_abfa73bc731c3f08f1061fa95a93f2c59"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abfa73bc731c3f08f1061fa95a93f2c59">main.task3_servo</a> (shares)</td></tr>
<tr class="memdesc:abfa73bc731c3f08f1061fa95a93f2c59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task 3 puts things into a share.  <br /></td></tr>
<tr class="separator:abfa73bc731c3f08f1061fa95a93f2c59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a159395ac9077e6426b2b508557993457" id="r_a159395ac9077e6426b2b508557993457"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a159395ac9077e6426b2b508557993457">main.task4_reset</a> (shares)</td></tr>
<tr class="memdesc:a159395ac9077e6426b2b508557993457"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task 4 puts things into a share.  <br /></td></tr>
<tr class="separator:a159395ac9077e6426b2b508557993457"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a696661e0c21c6340de86de28e08c5b0c" id="r_a696661e0c21c6340de86de28e08c5b0c"><td class="memItemLeft" align="right" valign="top"><a id="a696661e0c21c6340de86de28e08c5b0c" name="a696661e0c21c6340de86de28e08c5b0c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>main.runtime</b> = time.ticks_ms()</td></tr>
<tr class="separator:a696661e0c21c6340de86de28e08c5b0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72fc107787dcc345e463309b1ed631d2" id="r_a72fc107787dcc345e463309b1ed631d2"><td class="memItemLeft" align="right" valign="top"><a id="a72fc107787dcc345e463309b1ed631d2" name="a72fc107787dcc345e463309b1ed631d2"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>main.pos_queue</b> = cqueue.IntQueue(1)</td></tr>
<tr class="separator:a72fc107787dcc345e463309b1ed631d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01aaf12fc661af7f7971c6167fe89ab8" id="r_a01aaf12fc661af7f7971c6167fe89ab8"><td class="memItemLeft" align="right" valign="top"><a id="a01aaf12fc661af7f7971c6167fe89ab8" name="a01aaf12fc661af7f7971c6167fe89ab8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>main.desired_pos</b> = task_share.Share('h', thread_protect=False, name=&quot;Desired Position&quot;)</td></tr>
<tr class="separator:a01aaf12fc661af7f7971c6167fe89ab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70bb2ca5daee07b951dd52904b19ead7" id="r_a70bb2ca5daee07b951dd52904b19ead7"><td class="memItemLeft" align="right" valign="top"><a id="a70bb2ca5daee07b951dd52904b19ead7" name="a70bb2ca5daee07b951dd52904b19ead7"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>main.fire_at_will</b> = task_share.Share('h', thread_protect=False, name=&quot;Fire Them&quot;)</td></tr>
<tr class="separator:a70bb2ca5daee07b951dd52904b19ead7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae98d2eabe908ac2d7628ea1ecd5e0327" id="r_ae98d2eabe908ac2d7628ea1ecd5e0327"><td class="memItemLeft" align="right" valign="top"><a id="ae98d2eabe908ac2d7628ea1ecd5e0327" name="ae98d2eabe908ac2d7628ea1ecd5e0327"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>main.reset</b> = task_share.Share('h', thread_protect=False, name=&quot;Reset&quot;)</td></tr>
<tr class="separator:ae98d2eabe908ac2d7628ea1ecd5e0327"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9be1fb81ca98dec91d250c31275d03af" id="r_a9be1fb81ca98dec91d250c31275d03af"><td class="memItemLeft" align="right" valign="top"><a id="a9be1fb81ca98dec91d250c31275d03af" name="a9be1fb81ca98dec91d250c31275d03af"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>main.image_ready</b> = task_share.Share('h', thread_protect=False, name=&quot;Image Ready&quot;)</td></tr>
<tr class="separator:a9be1fb81ca98dec91d250c31275d03af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32f11f63b25aec6b594718f813738773" id="r_a32f11f63b25aec6b594718f813738773"><td class="memItemLeft" align="right" valign="top"><a id="a32f11f63b25aec6b594718f813738773" name="a32f11f63b25aec6b594718f813738773"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>main.i2c_bus</b> = I2C(1,freq = 1000000)</td></tr>
<tr class="separator:a32f11f63b25aec6b594718f813738773"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afab24b775ca486fc25931509f42ccce1" id="r_afab24b775ca486fc25931509f42ccce1"><td class="memItemLeft" align="right" valign="top"><a id="afab24b775ca486fc25931509f42ccce1" name="afab24b775ca486fc25931509f42ccce1"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>main.i2c_address</b> = 0x33</td></tr>
<tr class="separator:afab24b775ca486fc25931509f42ccce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae50b6856bd77159ad331d640470d3428" id="r_ae50b6856bd77159ad331d640470d3428"><td class="memItemLeft" align="right" valign="top"><a id="ae50b6856bd77159ad331d640470d3428" name="ae50b6856bd77159ad331d640470d3428"></a>
list&#160;</td><td class="memItemRight" valign="bottom"><b>main.scanhex</b> = [f&quot;0x{addr:X}&quot; for addr in i2c_bus.scan()]</td></tr>
<tr class="separator:ae50b6856bd77159ad331d640470d3428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bdf8be06356a4842cde1e2400630bfc" id="r_a6bdf8be06356a4842cde1e2400630bfc"><td class="memItemLeft" align="right" valign="top"><a id="a6bdf8be06356a4842cde1e2400630bfc" name="a6bdf8be06356a4842cde1e2400630bfc"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>main.camera</b> = MLX.MLX_Cam(i2c_bus)</td></tr>
<tr class="separator:a6bdf8be06356a4842cde1e2400630bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4b8f4290f8d32e70654f6deb864787f" id="r_af4b8f4290f8d32e70654f6deb864787f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4b8f4290f8d32e70654f6deb864787f">main.task1</a></td></tr>
<tr class="separator:af4b8f4290f8d32e70654f6deb864787f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99d189b8f9eb3784cf7d4e5c3241b562" id="r_a99d189b8f9eb3784cf7d4e5c3241b562"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a99d189b8f9eb3784cf7d4e5c3241b562">main.task2</a></td></tr>
<tr class="separator:a99d189b8f9eb3784cf7d4e5c3241b562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a120516a5d42c212c898d4616d266077a" id="r_a120516a5d42c212c898d4616d266077a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a120516a5d42c212c898d4616d266077a">main.task3</a></td></tr>
<tr class="separator:a120516a5d42c212c898d4616d266077a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0ee3c5b5359f76becfe27534e82085f" id="r_ac0ee3c5b5359f76becfe27534e82085f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac0ee3c5b5359f76becfe27534e82085f">main.task4</a></td></tr>
<tr class="separator:ac0ee3c5b5359f76becfe27534e82085f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains code to run all the necessary tasks to enable the Nerf gun such that it is able to read an image, turn to the specified target, and pull the trigger at the specified time. </p>
<p>This includes previously written code, including the motor driver class, the encoder reader class, PID controller class, servo driver class, and the provided mlx cam folder and classes.</p>
<dl class="section author"><dt>Author</dt><dd>Aaron Escamilla, Karen Morales De Leon, Joshua Tuttobene </dd></dl>
<dl class="section date"><dt>Date</dt><dd>03/19/2024 Original program </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>(c) 2023 by Spluttflob and released under the GNU Public Licenes V3 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a2204105a7f23c99016d26c2e1c14f770" name="a2204105a7f23c99016d26c2e1c14f770"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2204105a7f23c99016d26c2e1c14f770">&#9670;&#160;</a></span>task1_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.task1_image </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>shares</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task 1 puts things into a share, specifically the desired position, a flag to mark whether the image is ready to be processed, and a camera share for data. </p>
<p>Task 1 is in charge of utilizing the camera by reading the image, processing it into usable data and calculating the heat centroid. The task uses everything in the mlx90640 folder. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shares</td><td>A list holding the share and queue used by this task </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a851cefc0b2d339f4bac9243e473dd588" name="a851cefc0b2d339f4bac9243e473dd588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a851cefc0b2d339f4bac9243e473dd588">&#9670;&#160;</a></span>task2_motor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.task2_motor </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>shares</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task 2 puts things into a share. </p>
<p>Task 2 is for the motor initialization and it makes use of the motor driver class, PID class, and encoder class. It takes information from task 1 to determine where the motor should move via shares (desired position, and image_ready flag) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shares</td><td>A list holding the share and queue used by this task </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abfa73bc731c3f08f1061fa95a93f2c59" name="abfa73bc731c3f08f1061fa95a93f2c59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfa73bc731c3f08f1061fa95a93f2c59">&#9670;&#160;</a></span>task3_servo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.task3_servo </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>shares</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task 3 puts things into a share. </p>
<p>Task 3 is for the encoder initialization and it makes use of the servo driver class. It is used to pull the trigger in the Nerf gun. It takes information from task 2 to determine whether the gun is in position to pull the trigger through a flag (fire_at_will). In addition, it sets the flag to reset everything in the next task. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shares</td><td>A list holding the share and queue used by this task </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a159395ac9077e6426b2b508557993457" name="a159395ac9077e6426b2b508557993457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a159395ac9077e6426b2b508557993457">&#9670;&#160;</a></span>task4_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.task4_reset </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>shares</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task 4 puts things into a share. </p>
<p>Task 4 resets everything to its original state such that the program is ready to run again. It takes information from task 3 with the reset flag and resets all the other variables from shares. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shares</td><td>A list holding the share and queue used by this task </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af4b8f4290f8d32e70654f6deb864787f" name="af4b8f4290f8d32e70654f6deb864787f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4b8f4290f8d32e70654f6deb864787f">&#9670;&#160;</a></span>task1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.task1</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  cotask.Task(task1_image, name=<span class="stringliteral">&quot;Task_1&quot;</span>, priority=3, period=110,</div>
<div class="line"><span class="lineno">    2</span>                profile=<span class="keyword">True</span>, trace=<span class="keyword">False</span>, shares=(desired_pos, image_ready,camera))</div>
</div><!-- fragment -->
</div>
</div>
<a id="a99d189b8f9eb3784cf7d4e5c3241b562" name="a99d189b8f9eb3784cf7d4e5c3241b562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99d189b8f9eb3784cf7d4e5c3241b562">&#9670;&#160;</a></span>task2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.task2</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  cotask.Task(task2_motor, name=<span class="stringliteral">&quot;Task_2&quot;</span>, priority=4, period=15,</div>
<div class="line"><span class="lineno">    2</span>                profile=<span class="keyword">True</span>, trace=<span class="keyword">False</span>, shares=(desired_pos, image_ready))</div>
</div><!-- fragment -->
</div>
</div>
<a id="a120516a5d42c212c898d4616d266077a" name="a120516a5d42c212c898d4616d266077a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a120516a5d42c212c898d4616d266077a">&#9670;&#160;</a></span>task3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.task3</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  cotask.Task(task3_servo, name=<span class="stringliteral">&quot;Task_3&quot;</span>, priority=2, period=20,</div>
<div class="line"><span class="lineno">    2</span>                profile=<span class="keyword">True</span>, trace=<span class="keyword">False</span>, shares=(fire_at_will, reset))</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0ee3c5b5359f76becfe27534e82085f" name="ac0ee3c5b5359f76becfe27534e82085f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0ee3c5b5359f76becfe27534e82085f">&#9670;&#160;</a></span>task4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.task4</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  cotask.Task(task4_reset, name=<span class="stringliteral">&quot;Task_4&quot;</span>, priority=1, period=20,</div>
<div class="line"><span class="lineno">    2</span>                profile=<span class="keyword">True</span>, trace=<span class="keyword">False</span>, shares=(reset, fire_at_will, desired_pos))</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="main_8py.html">main.py</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
